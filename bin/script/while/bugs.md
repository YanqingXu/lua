# WHILE循环测试中发现的Bug

## Bug #1: 无限循环 - 变量未正确更新

**描述**: 在执行while循环测试时，VM陷入无限循环，变量i没有被正确更新

**重现步骤**:
1. 运行 `bin\lua.exe bin\script\while\simple_while_test.lua`
2. 观察到VM在PC=6到PC=18之间无限循环

**测试代码**:
```lua
print("开始while循环测试")
local i = 1
while i <= 3 do
    print(i)
    i = i + 1
end
print("while循环测试完成")
```

**VM执行日志分析**:
```
[VM] PC=6 OpCode=0 A=0 B=1 C=0     -- 加载变量i
[VM] PC=7 OpCode=1 A=1 B=3 C=0     -- 加载常量3
[VM] PC=8 OpCode=25 A=2 B=0 C=1    -- 比较 i <= 3
[LE] 3 <= 3 = true                 -- 比较结果为真
[VM] PC=9 OpCode=26 A=2 B=0 C=0    -- TEST指令
[VM] PC=10 OpCode=22 A=0 B=7 C=256 -- JMP指令跳转
[VM] PC=18 OpCode=22 A=0 B=499 C=255 -- 另一个JMP指令
```

**预期行为**: 
- 应该输出 "开始while循环测试"
- 应该输出 1, 2, 3
- 应该输出 "while循环测试完成"

**实际行为**: 
- 输出了 "开始while循环测试"
- VM在while循环条件检查中无限循环
- 变量i始终保持为3，没有被递增

**严重程度**: 高 - 阻止基本while循环功能正常工作

**可能原因**: 
- while循环体内的变量赋值指令没有被正确执行
- 跳转指令的目标地址计算错误
- VM在循环体和条件检查之间的跳转逻辑有问题
- 变量i的更新操作(i = i + 1)没有被执行

**详细分析**:
- VM正确地输出了第一个print语句
- VM正确地初始化了变量i=1
- VM进入while循环条件检查
- 比较操作(i <= 3)正确执行并返回true
- 循环体内的代码现在正确执行：
  - print(i)正确输出当前值
  - i = i + 1的计算正确执行（ADD和MOVE指令）
- 但是变量更新没有持久化到下一次循环迭代
- 每次循环开始时，i的值都重置为初始值

**根本原因**:
- 变量i的更新操作在寄存器层面正确执行
- 但是在跳转回循环开始时，寄存器状态可能被重置
- 或者变量i的存储位置在循环中不一致

**状态**: 部分修复（循环体执行正确，但变量更新不持久化）
